# 1. Below are defaults, update them to your specifications
# 2. Set secrets via CLI before running Pulumi:
#   pulumi config set --secret proxmox:apiToken "root@pam!mytoken=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
#   pulumi config set --secret proxmox:endpoint: https://<proxmox-host-IP>:8006
#   pulumi config set --secret proxmox:insecure: <true|false>

config:
  # ---- Anchors example ----
  x-cpu: &cpu
    cores: 1
    sockets: 1

  x-memory: &memory
    dedicated: 1000 # MB

  x-disk: &disk
    interface: scsi0
    datastoreId: local-lvm
    size: 20
    fileFormat: qcow2
  
  x-network: &network
    bridge: vmbr0
    model: virtio

  x-clone_template: &clone_template
    nodeName: proxmox1
    vmId: 9000  # Template VM ID
    full: true

  x-cloudinit: &cloudinit
    datastoreId: local-lvm
    ipv4:
      address: 10.0.0.100/24
      gateway: 10.0.0.1
    dns:
      domain: lab
      servers: [10.0.0.1, 8.8.8.8]
    sshKeys:
      - "ssh-rsa AAAAB3NzaC1yc2E... your-key-here"
    username: admin

  # VM configurations
  vms:
    # VM 1 - Cloned from template
    - name: server-01
      nodeName: proxmox1  # Proxmox host name
      vmId: 100       # Optional: specific VM ID
      cpu: *cpu
      memory: *memory
      disk: *disk`
      network: *network
      clone: *clone_template
      cloudInit: *cloudinit
    
    # VM 2 - Different host, different configuration
    - name: server-02
      nodeName: proxmox2
      vmId: 101
      cpu: *cpu
      memory: *memory
      disk: *disk
      network: *network
      clone:
        <<: *clone_template
        nodeName: proxmox2
      cloudInit:
        <<: *cloudinit
        ipv4:
          address: 10.0.0.101/24
    
    # VM 3 - Another VM on first host
    - name: worker-01
      nodeName: proxmox1
      vmId: 102
      cpu:
        cores: 1
        sockets: 1
      memory:
        dedicated: 1000
      disk:
        interface: scsi0
        datastoreId: local-lvm
        size: 20
      network:
        bridge: vmbr0
        model: virtio
      clone:
        nodeName: pve1
        vmId: 9000
        full: true
      cloudInit:
        datastoreId: local-lvm
        ipv4:
          address: 10.0.0.102/24
          gateway: 10.0.0.1
        sshKeys:
          - "ssh-rsa AAAAB3NzaC1yc2E... your-key-here"
